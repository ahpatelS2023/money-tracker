{"ast":null,"code":"/**\r\n * Save file in browser\r\n *\r\n * @module save-file/browser\r\n */\n'use strict';\n\nvar saveAs = require('file-saver').saveAs;\n\nvar toBlob = require('./src/to-blob');\n\nvar planned = null;\nmodule.exports = save;\nmodule.exports.save = save;\nmodule.exports.saveSync = saveSync;\n\nfunction save(data, filename) {\n  // swap data/filename\n  if (typeof data === 'string') {\n    // writing string to string - take the lengthier\n    if (typeof filename !== 'string' || filename.length > data.length) {\n      var x = filename;\n      filename = data;\n      data = x;\n    }\n  }\n\n  var blob = toBlob(data, filename);\n\n  if (planned) {\n    return planned.then(function () {\n      planned = save(data, filename);\n      return planned;\n    });\n  } else {\n    planned = new Promise(function (ok, nok) {\n      saveAs(blob, filename); //prompt next dialog only when window got focus back\n\n      window.addEventListener('focus', function resolve() {\n        planned = null;\n        window.removeEventListener('focus', resolve);\n        ok();\n      });\n    });\n    return planned;\n  }\n}\n\nfunction saveSync(data, filename) {\n  return saveAs(toBlob(data, filename), filename);\n}","map":null,"metadata":{},"sourceType":"script"}